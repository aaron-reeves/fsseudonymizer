[Table of contents](_tableOfContents.md)  
Previous: [System requirements and installation](systemRequirements.md) | Next: [The user interface](userInterface.md)

# _Fsseudonymizer:_ Using the program

This page provides an overview of the use of _Fsseudonymizer_.  [The next page](userInterface.md) describes the user interface itself.

_Fsseudonymizer_ is intended to be run by organizations and individuals that are authorized to hold confidential or sensitive data (the **data providers**).  Pseudonymized output generated by _Fsseudonymizer_ can then be passed on to **data users**, for whom pseudonymous data is suitable for further analysis.

## The pass phrase

_Fsseudonymizer_ makes use of an original piece of data (for example, a name) in combination with a computational algorithm known as a cryptographic hash (described in more detail [here](techDetails.md)) to generate a unique, pseudonymous representation of the original data, called a "hash value".

Although it is not possible to recover original data from its hash value, it would be possible for relatively simple, predictable data formats to deduce what the original data was.  For example, consider American Social Security Numbers (SSN).  Every SSN is a 9-digit number.  There are only one billion possible social security numbers.  It would be possible to generate a list of hash values for all one billion possibilities.  If it were known that a piece of original data was a Social Security Number, one could determine what the original data must have been by comparing a particular hash value to all of those those on this list.

In order to add an extra level of security, _Fsseudonymizer_ also uses a **pass phrase**.  A pass phrase is a string of several randomly selected words that would be difficult to guess.  When a pass phrase is combined with a piece of data and then both subjected to a cryptographic hash algorithm, a unique data identifier is still generated, but without access to the pass phrase, it becomes virtually impossible to apply brute-force techniques to deduce the contents of the original data.

**_Pass phrases should be known only to the data provider(s), treated as sensitive information, and held securely._**  For some simple data types (_e.g._, the Social Security Number example as discussed above), it would be possible to circumvent the pseudonymization process if a pass phrase happened to be shared.

In the event that different data sets are to be pseudonymized for the same purpose or the same data user, the same pass phrase should be used to ensure consistency of results.  _Fsseudonymizer_ provides a way to check that this (see [Output file contents](usage.md#markdown-header-output-file-contents) below), in the event that any errors occurred.

[//]: # (## The Rules file TODO: Write this section)

## Input file formats

_Fsseudonymizer_ currently processes input files of the following types:

  - _Microsoft Excel_ 97-2003 (*.xls) spreadsheets
  - _Microsoft Excel_ 2007 or later (*.xlsx) spreadsheets
    - Spreadsheet files should must data in only one sheet.  _Fsseudonymizer_ will issue an error message if this is not the case.
  - CSV (comma-separated values) files
    - Only commas are currently recognized as delimiting characters.  If your data file uses another delimiter, such as a semicolon or a tab, the data file will have to be modified.  (It would not be difficult to implement an option to use other delimiters: please see [Information for developers](developers.md) or [contact us](contacts.md) if this is a desired feature.)
    - Likewise, only quotation marks (") are currently recognized as text/quotation delimiters.

Input files must be reasonably [tidy](https://vita.had.co.nz/papers/tidy-data.html):

  - Data must be tabular, arranged in columns and rows
  - The first row must contain field names or column headers
  - Every column must have a field name, and every field name should be unique. (Uniqueness of field names is not an absolute requirement, but it is a very good idea nonetheless.  If any field names are found to be duplicated, _Fsseudonymizer_ will modify them by appending a number to ensure that they are unique.)

The following table illustrates a tidy input file suitable for use with _Fsseudonymizer_:

| Name          | Age | Height-inches | Weight-pounds |
|:--------------|----:|--------------:|--------------:|
| Hank Hill     | 39  | 73            | 220           |
| Eric Cartman  | 10  | 38            | 100           |
| Marge Simpson | 43  | 78            | 135           |

**_It is essential that input data is clean and consistent to begin with._**  Consider a data file that contains the names "Homer Simpson", "Homer J Simpson", and "Homer J. Simpson".  In their not-yet-pseudonymous form, it is apparent that these three names likely all refer to the same person.  The table below shows each of these names alongside pseudonyms generated using _Fsseudonymizer_ with the pass phrase "duckbill bent limbate hamlet".  (Note that this is presented purely for illustration, and that no such table is ever produced by _Fsseudonymizer_: this would largely defeat the purpose!)

| Name             | Pseudonymous version                                     |
|------------------|----------------------------------------------------------|
| Homer Simpson    | eb756672f9d92067409026d3acd7dedd57912cca229fdce6a9577c28 |
| Homer J Simpson  | 0e837c9e64f132202c51b93719a82745ac45ec40c9ca638d8c1838d4 |
| Homer J. Simpson | 0a480d19a31d79813cc8b49fe26f0389dcfe6c0258fb2c96551d06c0 |

The pseudonymous identifiers are radically different from one another.  It would be impossible for the data user to know that these in fact represented the same individual, and any subsequent analysis will be incomplete or incorrect.

## Output file contents

_Fsseudonymizer_ will produce output files as either _Microsoft Excel_ 2007 (*.xlsx) formatted files or CSV files.

Contents of an output file will follow the same structure, regardless of its format.  An output file will contain several lines of file headers, followed by a pseudonymized version of the input data, as shown in the figure below:

```
# Fsseudonymizer pseudonymized data file
# Application version: 1.0.0.20191105
# Generation date: 07 Nov 2019 14:27:24
# Generated by: Fred Flintsone <fred.flintstone@slaterock.com>
# Encryption validity check: b0cf07e59b28dbd04c7831e78b7254e94622048c795eb25b9b8d8859
  
Name                                                      Age  Height-inches  Weight-pounds
86311007ce37c8131eea488fd822c62b9c6a0201785ba4196a552933  39   73             220
4a23765ce0e35c7faa229042ac80d4a7be8072aed0d9e0b2efc42164  10   38             100
30f501ff64a73aecd4fcd3b56200c06954d88e0f97dd9a1a5cb7a5f6  43   78             135
```

The header rows provide some useful metadata regarding the file, including the version of _Fsseudonymizer_ that was used to produce it, the date and time that the output file was generated, and the name and email address of a contact person.  A final header row, the encryption validity check, is discussed below.

Below the header rows is the data table.  Note that original data in the fields that require pseudonymization (in this case, the ```Name``` column) has been replaced with pseudonymous identifiers (hash values).

### The encryption validity check

The encryption validity check is a special hash value that can be used to ensure consistency across multiple data files.  Suppose, for example, that multiple data files from different sources (or possibly even different data providers) need to be pseudonymized.  In order for hash values to be useful as unique identifiers, they must be consistent across all data sets: the hash value in the table above that represents "Marge Simpson" must represent "Marge Simpson", regardless of the source of the data.  Based only on the pseudonymized data, the data user would have no way to know that this was true.

The encryption validity check is a special data element included by _Fsseudonymizer_ and processed in the same way as all of the rest of the data, and using the same pass phrase.  This check does not reveal the pass phrase, but it can be used to demonstrate whether multiple input files were generated using the same options.

If the data user receives two _Fsseudonymizer_ output files which represent the same data but do not have the same encryption validity check, she will know immediately that the two files were not pseudonymized with the same pass phrase, and thus are not consistent with one another.  Fortunately, she will have the name and address of the data provider (in another of the output header rows), so the mistake can be corrected by running _Fsseudonymizer_ again.
